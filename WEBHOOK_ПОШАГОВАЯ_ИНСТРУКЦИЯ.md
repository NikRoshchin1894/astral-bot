# üåê –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å Webhook –∏ –æ—Ç–∫–ª—é—á–∏—Ç—å Polling - –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## ‚úÖ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### –®–∞–≥ 1: –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ TELEGRAM_WEBHOOK_URL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è):

```bash
# –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞:
TELEGRAM_WEBHOOK_URL=https://nikroshchin1894-astral-bot-e77d.twc1.net/webhook/telegram
```

**–í–∞–∂–Ω–æ:**
- URL –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `https://`
- URL –¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ `/webhook/telegram`
- URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞

### –®–∞–≥ 2: –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π webhook (–µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç)

–ï—Å–ª–∏ –±–æ—Ç —Ä–∞–Ω—å—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª polling, —É–¥–∞–ª–∏—Ç–µ webhook:

```bash
python remove_webhook.py
```

–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –Ω–µ –±—É–¥–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞.

### –®–∞–≥ 3: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –±–æ—Ç–∞

```bash
# –ù–∞–π—Ç–∏ –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –±–æ—Ç–∞
ps aux | grep bot.py

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
pkill -f bot.py
# –∏–ª–∏ –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è systemd:
sudo systemctl stop astral-bot
```

### –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–í–∞—Ä–∏–∞–Ω—Ç –ê: –ß–µ—Ä–µ–∑ systemd (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

```bash
sudo systemctl start astral-bot
sudo systemctl enable astral-bot  # –¥–ª—è –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
```

**–í–∞—Ä–∏–∞–Ω—Ç –ë: –í—Ä—É—á–Ω—É—é (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)**

```bash
cd /path/to/Astral_Bot
source venv/bin/activate  # –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ venv
python bot.py
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:

```
üåê –ó–∞–ø—É—Å–∫ webhook —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ 0.0.0.0:8080
   üì± Telegram webhook: /webhook/telegram
   üí≥ YooKassa webhook: /webhook/yookassa
‚úÖ Webhook —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
üîó –£—Å—Ç–∞–Ω–æ–≤–∫–∞ webhook –≤ Telegram...
‚úÖ Webhook —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Telegram
‚úÖ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Ä–µ–∂–∏–º–µ WEBHOOK –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!
```

**–ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
üîÑ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ POLLING
```

### –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

```bash
python check_bot_status.py
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å:
```
‚úÖ Webhook –£–°–¢–ê–ù–û–í–õ–ï–ù
   URL: https://nikroshchin1894-astral-bot-e77d.twc1.net/webhook/telegram
```

### –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å webhook

```bash
python check_all_webhooks.py
```

–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
‚úÖ Telegram webhook: –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
```

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

### –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è POLLING –≤–º–µ—Å—Ç–æ WEBHOOK:

**–ü—Ä–∏—á–∏–Ω–∞ 1:** `TELEGRAM_WEBHOOK_URL` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- ‚úÖ –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`: `TELEGRAM_WEBHOOK_URL=https://...`

**–ü—Ä–∏—á–∏–Ω–∞ 2:** Webhook —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
- ‚úÖ –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç 8080 —Å–≤–æ–±–æ–¥–µ–Ω

**–ü—Ä–∏—á–∏–Ω–∞ 3:** Webhook URL –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ URL –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (–Ω–µ localhost)

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã

–í –ª–æ–≥–∞—Ö –±–æ—Ç–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±—É–¥–µ—Ç –ª–∏–±–æ:
- `üåê –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ WEBHOOK` - ‚úÖ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- `üîÑ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ POLLING` - ‚ùå –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –≤—Å–µ —Ä–∞–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç polling

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `TELEGRAM_WEBHOOK_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `.env`
2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```bash
   # –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ systemd, –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:
   sudo systemctl restart astral-bot
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ WEBHOOK"

### –ü—Ä–æ–±–ª–µ–º–∞: Webhook –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–¥–∞–ª–∏—Ç–µ —Å—Ç–∞—Ä—ã–π webhook: `python remove_webhook.py`
2. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1 –º–∏–Ω—É—Ç—É
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –∑–∞–Ω–æ–≤–æ
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∞ 502 –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ webhook

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ—Ä—Ç 8080 –æ—Ç–∫—Ä—ã—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–∫—Å–∏/–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç

–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

- [ ] `TELEGRAM_WEBHOOK_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `.env`
- [ ] URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (https://, –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ /webhook/telegram)
- [ ] –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –±–æ—Ç–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] –°—Ç–∞—Ä—ã–π webhook —É–¥–∞–ª–µ–Ω (–µ—Å–ª–∏ –±—ã–ª)
- [ ] –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- [ ] –í –ª–æ–≥–∞—Ö –µ—Å—Ç—å "–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ WEBHOOK"
- [ ] Webhook —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏–ª—Å—è (–ø–æ—Ä—Ç 8080)
- [ ] Webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Telegram (–ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `check_bot_status.py`)
- [ ] Webhook –¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (–Ω–µ 502)

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞

–ï—Å–ª–∏ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ, –ø—Ä–æ—Å—Ç–æ:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
sudo systemctl restart astral-bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
python check_bot_status.py
```

–î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: `‚úÖ Webhook –£–°–¢–ê–ù–û–í–õ–ï–ù`

---

**–ì–ª–∞–≤–Ω–æ–µ:** –ï—Å–ª–∏ `TELEGRAM_WEBHOOK_URL` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å webhook —Ä–µ–∂–∏–º –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ!

