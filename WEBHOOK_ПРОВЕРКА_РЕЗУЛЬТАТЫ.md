# ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ Webhook

–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏: $(date)

## üéâ –û–¢–õ–ò–ß–ù–´–ï –ù–û–í–û–°–¢–ò!

### ‚úÖ Telegram Webhook - –†–ê–ë–û–¢–ê–ï–¢!

- ‚úÖ **Webhook –£–°–¢–ê–ù–û–í–õ–ï–ù** –≤ Telegram
- ‚úÖ URL: `https://nikroshchin1894-astral-bot-e77d.twc1.net/webhook/telegram`
- ‚úÖ Endpoint –¥–æ—Å—Ç—É–ø–µ–Ω –∏ –æ—Ç–≤–µ—á–∞–µ—Ç (HTTP 200)
- ‚úÖ –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ **WEBHOOK** (–Ω–µ polling!)

### ‚úÖ YooKassa Webhook - –†–ê–ë–û–¢–ê–ï–¢!

- ‚úÖ Endpoint –¥–æ—Å—Ç—É–ø–µ–Ω (HTTP 200)
- ‚úÖ Webhook –æ—Ç–≤–µ—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Health endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç: `{"status":"ok"}`
- ‚úÖ URL: `https://nikroshchin1894-astral-bot-e77d.twc1.net/webhook/yookassa`

---

## üìä –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### 1. Telegram Webhook

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –£–°–¢–ê–ù–û–í–õ–ï–ù –ò –†–ê–ë–û–¢–ê–ï–¢

- URL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Telegram API: ‚úÖ
- Endpoint –¥–æ—Å—Ç—É–ø–µ–Ω: ‚úÖ (HTTP 200)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç HTTPS: ‚úÖ
- –û–∂–∏–¥–∞—é—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: 0

**–í—ã–≤–æ–¥:** –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ WEBHOOK! ‚úÖ

### 2. YooKassa Webhook

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ –ö–û–†–†–ï–ö–¢–ù–û

- URL –Ω–∞—Å—Ç—Ä–æ–µ–Ω: ‚úÖ
- Endpoint –¥–æ—Å—Ç—É–ø–µ–Ω: ‚úÖ (HTTP 200)
- Health endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç: ‚úÖ
- Credentials —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã: ‚úÖ

**–í—ã–≤–æ–¥:** –ì–æ—Ç–æ–≤ –∫ –ø—Ä–∏–µ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ—Ç YooKassa! ‚úÖ

### 3. –ö–æ–Ω—Ñ–ª–∏–∫—Ç (409)

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω, –Ω–æ –ù–ï –∫—Ä–∏—Ç–∏—á–Ω–æ

- –ü—Ä–∏—á–∏–Ω–∞: –í–æ–∑–º–æ–∂–Ω–æ, –∑–∞–ø—É—â–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∏–ª–∏ —Å—Ç–∞—Ä–∞—è —Å–µ—Å—Å–∏—è
- –í–ª–∏—è–Ω–∏–µ: –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ, —Ç–∞–∫ –∫–∞–∫ webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –†–µ—à–µ–Ω–∏–µ: –ú–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å, –µ—Å–ª–∏ webhook —Ä–∞–±–æ—Ç–∞–µ—Ç

**–í—ã–≤–æ–¥:** Webhook —Ä–∞–±–æ—Ç–∞–µ—Ç, –∫–æ–Ω—Ñ–ª–∏–∫—Ç –Ω–µ –º–µ—à–∞–µ—Ç! ‚úÖ

---

## üéØ –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

### ‚úÖ –í–°–ï –†–ê–ë–û–¢–ê–ï–¢!

- ‚úÖ Telegram webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ YooKassa webhook –¥–æ—Å—Ç—É–ø–µ–Ω –∏ –≥–æ—Ç–æ–≤
- ‚úÖ –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ WEBHOOK (–Ω–µ polling!)
- ‚úÖ –í—Å–µ endpoints –æ—Ç–≤–µ—á–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìù –ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

### 1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å webhook –≤ YooKassa

1. –í–æ–π–¥–∏—Ç–µ –≤ [–ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç YooKassa](https://yookassa.ru/my)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
3. –î–æ–±–∞–≤—å—Ç–µ webhook URL:
   ```
   https://nikroshchin1894-astral-bot-e77d.twc1.net/webhook/yookassa
   ```
4. –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–±—ã—Ç–∏—è:
   - ‚úÖ `payment.succeeded` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
   - ‚úÖ `payment.canceled` (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

### 2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–ø–ª–∞—Ç—É

1. –û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞: @Astralogy_bot
2. –ù–∞–∂–º–∏—Ç–µ "–û–ø–ª–∞—Ç–∏—Ç—å" –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ "–ù–∞—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞"
3. –û–ø–ª–∞—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–π –∫–∞—Ä—Ç–æ–π:
   - **–ù–æ–º–µ—Ä**: `5555 5555 5555 4444`
   - **–°—Ä–æ–∫**: –ª—é–±–æ–π –±—É–¥—É—â–∏–π –º–µ—Å—è—Ü/–≥–æ–¥
   - **CVV**: `123`
   - **3D Secure**: `12345`
4. –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –±–æ—Ç –¥–æ–ª–∂–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
   - –ü–æ–ª—É—á–∏—Ç—å webhook –æ—Ç YooKassa
   - –ü–æ–º–µ—Ç–∏—Ç—å –≤–∞—Å –∫–∞–∫ –æ–ø–ª–∞—Ç–∏–≤—à–µ–≥–æ
   - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞—Ç–∞–ª—å–Ω—É—é –∫–∞—Ä—Ç—É (–µ—Å–ª–∏ –ø—Ä–æ—Ñ–∏–ª—å –∑–∞–ø–æ–ª–Ω–µ–Ω)

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –±–æ—Ç–∞
python check_bot_status.py

# –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö webhook
python check_all_webhooks.py

# –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
python diagnose_webhook.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –æ–ø–ª–∞—Ç—ã
python check_payment_readiness.py
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç

- [x] Telegram webhook —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [x] Telegram webhook –¥–æ—Å—Ç—É–ø–µ–Ω (HTTP 200)
- [x] YooKassa webhook –¥–æ—Å—Ç—É–ø–µ–Ω (HTTP 200)
- [x] Health endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ WEBHOOK
- [ ] Webhook –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ YooKassa (–Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å)
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂ –ø—Ä–æ–≤–µ–¥–µ–Ω (–Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å)

---

## üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!

**Webhook –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!**

–ë–æ—Ç —Ç–µ–ø–µ—Ä—å:
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ WEBHOOK (–±—ã—Å—Ç—Ä–µ–µ –∏ –Ω–∞–¥–µ–∂–Ω–µ–µ)
- ‚úÖ –ì–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç Telegram
- ‚úÖ –ì–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ—Ç YooKassa
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç –ø–ª–∞—Ç–µ–∂–∏ –∏ –≤—ã–¥–∞—Å—Ç –Ω–∞—Ç–∞–ª—å–Ω—É—é –∫–∞—Ä—Ç—É

**–û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å webhook –≤ YooKassa!** üöÄ

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –†–ê–ë–û–¢–ê–ï–¢!

