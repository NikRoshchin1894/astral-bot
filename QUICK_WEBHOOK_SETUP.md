# –ë—ã—Å—Ç—Ä–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Webhook YooKassa ‚ö°

## –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è (5 –º–∏–Ω—É—Ç)

### 1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –≤–∞—à webhook URL

**–§–æ—Ä–º–∞—Ç:** `https://–≤–∞—à-–¥–æ–º–µ–Ω.com/webhook/yookassa`

**–ü—Ä–∏–º–µ—Ä—ã:**
- Railway: `https://your-app.railway.app/webhook/yookassa`
- Render: `https://your-app.onrender.com/webhook/yookassa`
- VPS: `https://your-domain.com/webhook/yookassa`

### 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è

**Railway:**
```
YOOKASSA_WEBHOOK_URL=https://your-app.railway.app/webhook/yookassa
```

**Render:**
```
YOOKASSA_WEBHOOK_URL=https://your-app.onrender.com/webhook/yookassa
```

**–õ–æ–∫–∞–ª—å–Ω–æ (.env):**
```
YOOKASSA_WEBHOOK_URL=https://your-ngrok-url.ngrok.io/webhook/yookassa
```

### 3. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ webhook –≤ YooKassa

1. –í–æ–π–¥–∏—Ç–µ –≤ https://yookassa.ru/
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: **–ù–∞—Å—Ç—Ä–æ–π–∫–∏** ‚Üí **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**
3. –î–æ–±–∞–≤—å—Ç–µ URL: `https://–≤–∞—à-–¥–æ–º–µ–Ω.com/webhook/yookassa`
4. –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–±—ã—Ç–∏—è:
   - ‚úÖ `payment.succeeded`
   - ‚úÖ `payment.canceled`
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É

```bash
python check_webhook_setup.py
```

### 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞. –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
```
üåê –ó–∞–ø—É—Å–∫ webhook —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ 0.0.0.0:8080
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –ø–ª–∞—Ç–µ–∂** —á–µ—Ä–µ–∑ –±–æ—Ç–∞
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** ‚Äî –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è:
   ```
   üîî –ü–æ–ª—É—á–µ–Ω webhook –æ—Ç –ÆKassa: event=payment.succeeded
   ‚úÖ –ü–ª–∞—Ç–µ–∂ ... —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω —á–µ—Ä–µ–∑ webhook
   ```

---

## –í–∞–∂–Ω–æ ‚ö†Ô∏è

- ‚úÖ URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **HTTPS** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)
- ‚úÖ URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞**
- ‚úÖ URL –¥–æ–ª–∂–µ–Ω **–∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞** `/webhook/yookassa`

---

## –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

–°–º. —Ñ–∞–π–ª `YOOKASSA_WEBHOOK_SETUP.md` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

